---
title: "Substitutionplot"
description: "R script to create substitution plot"
categories: [R, accuracy, rna004]
---

```
<img width="1024" height="1536" alt="Substitution Plot Jul 9, 2025" src="https://github.com/user-attachments/assets/5e0a4fbe-6812-4c3f-ae4a-617e8cf9f60a" />

args <- commandArgs(trailingOnly = TRUE)

library(lattice)

f <- args[1]
out <- args[2]
inf <- args[3]
print("beginning panel function")
# Custom panel function with larger font size for text
myPanel <- function(x, y, z, ...) {
    panel.levelplot(x, y, z, ...)
    # Increase font size using cex argument
    panel.text(x, y, labels = paste(100 * round(exp(-z),4), "%", sep=""), cex = 1.5) # Adjust cex for larger font
}


print("reading data")

d <- read.table(f, header = TRUE, row.names = 1)



if (dim(d)[1] > 0 && sum(d) > 0) {
    
print("plotting as tiff now")
    # Use tiff() instead of pdf(), specify resolution
    tiff(filename = out, units = "in", width = 8, height = 6, res = 300)
print("making level plot or printing now")
    p <- levelplot(as.matrix(-log(d)), main = inf, xlab = "Reference bases", ylab = "Read bases", panel = myPanel, col.regions = colorRampPalette(c("white", "red"))(256))
    
    print(p)
    
    dev.off()
    
}
```